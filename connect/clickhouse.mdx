---
title: "ClickHouse Setup Guide"
---

1. Create a separate database for the ClickHouse peer called peerdb. This is where tables will be auto-created and synced by PeerDB.
```sql
   CREATE DATABASE peerdb;
```
2. Create a Clickhouse user for PeerDB with the following permissions:
```sql
-- We recommend creating a separate user for PeerDB
CREATE USER peerdb_user IDENTIFIED BY '<password>';

-- PeerDB needs to create tables and insert data into the tables.
-- Drop table permission is needed for DROP MIRROR support
GRANT INSERT, SELECT, DROP, CREATE TABLE ON peerdb.* to peerdb_user;

-- PeerDB uses an intermediary S3 stage for performance
GRANT CREATE TEMPORARY TABLE, s3 on *.* to peerdb_user;

-- For automatic column-addition on the tables in the mirror
GRANT ALTER ADD COLUMN ON peerdb.* to peerdb_user;

-- For setting the synced-at column during resyncing of a mirror
GRANT ALTER UPDATE ON peerdb.* to peerdb_user;
```
3. ClickHouse has several ports exposed, and PeerDB requires to use a port that exposes the `ClickHouse native protocol` which by default is `9440` for the secure TLS-enabled port and `9000` for the non-TLS port. If the default ports have been changed, please adjust them accordingly.
<Warning>
We do not recommend using the non-TLS enabled port for ClickHouse. If this is needed, please also check the `Disable TLS?` option.
</Warning>
4. If you are using PeerDB OSS, we use [MinIO](https://min.io/) as the internal transient stage. You might need to adjust your firewall rules to allow connections from ClickHouse to MinIO. In [PeerDB Cloud](https://app.peerdb.cloud/), we abstract all of this from you. If you run into issues, please reach out to support@peerdb.io or join our Slack [channel](https://join.slack.com/t/peerdb-public/shared_invite/zt-1wo9jydev-EXInbMtCtpAKFFWdi7QvLQ).
5. Create the ClickHouse Peer through UI
    <Frame caption="Choose PostgreSQL Peer">
    <img src="/images/setup/clickhouse/clickhousepeer.png" />
    </Frame>
    Enter all the details `Name`, `Host`, `Port` (as determined above), `User`, `Password` and `Database` along with S3 credentials to setup the peer.
