---
title: Quickstart Guide
description: "Get started with PeerDB in a few simple steps."
---

### Deploying PeerDB

We currently support deploying and testing PeerDB using our Docker Compose file, support for Kubernetes and other means of deployment are in development.

<Info> Docker can be installed by referring to [these instructions](https://www.docker.com/products/docker-desktop). The `docker compose` tool should also be present. The Postgres client tools (specifically `psql`) are used to test the PeerDB installation. </Info>

1.  **Run the following commands in your terminal:**

    ```bash
    git clone --recursive git@github.com:PeerDB-io/peerdb.git
    cd peerdb
    
    # Run docker containers: peerdb-server, postgres as catalog, temporal
    export COMPOSE_PROJECT_NAME=peerdb-stack
    docker compose up
    ```

3.  **Connect to PeerDB:**


    ```bash
    psql "port=9900 host=localhost password=peerdb"
    ```

That's it! You now have PeerDB up and running on your machine, ready to query away!

### Quickstart

<Info> The following steps assume you have PeerDB running locally. We also need the Postgres client tools (specifically `psql` and `pgbench`) installed and available on your PATH. </Info>

#### Create a Peer

With PeerDB running, we can create our first peers.

    ```bash
    curl -O https://peerdb-sample-data.s3.us-east-2.amazonaws.com/quickstart_prepare_peers.sh
    chmod +x quickstart_prepare_peers.sh
    ./quickstart_prepare_peers.sh
    ```

This script reuses the PeerDB internal Postgres cluster to setup two databases, which we can use to create two peers. It also creates some tables on both databases to use later in the quickstart.

<Warning> The connection string of another Postgres cluster can be provided as an argument to the script if needed. However, destructive DDL commands are run without any confirmation, so be wary of data loss! All commands that follow must be changed to match up with the new cluster. </Warning>

We can now create the peers by pasting the following commands into the `psql` terminal connected to PeerDB.

    ```sql
    CREATE PEER peersrc FROM POSTGRES WITH
    (
        host = 'catalog',
        port = '5432',
        user = 'postgres',
        password = 'postgres',
        database = 'peersrc'
    );
    ```

    ```sql
    CREATE PEER peerdst FROM POSTGRES WITH
    (
        host = 'catalog',
        port = '5432',
        user = 'postgres',
        password = 'postgres',
        database = 'peerdst'
    );
    ```

#### Creating mirrors

One of the core features of PeerDB is moving data between tables, either directly or after transformation. We do this via two types of mirrors: `CDC` and `QRep`. The former is used to move data from source tables to identical destination tables, while the latter is used to move the results from a query on the source to a destination table.

Run the following SQL commands to set up a CDC mirror and QRep mirror between our two posts.

    ```sql
    --- CDC mirrors automatically create the destination table
    CREATE MIRROR cdc_mirror FROM peersrc TO peerdst WITH TABLE MAPPING (public.tablesrc:public.tabledst_cdc);
    ```

    ```sql
    --- QRep mirrors require the destination table to be created beforehand, which we did in the previous step.
    CREATE MIRROR qrep_mirror FROM peersrc TO peerdst
    FOR $$SELECT id, c1+c2 AS c12, substring(t FROM 0 FOR 8) AS st FROM tablesrc WHERE id >= {{.start}} AND id < {{.end}}$$ WITH (
        watermark_table_name='public.tablesrc',
        watermark_column='id',
        destination_table_name='public.tabledst_qrep',
        mode='append',
        parallelism=2,
        batch_size_int=50000,
        refresh_interval=10
    );
    --- 'append' mode indicates that the records in the source table are write-once and never updated. 
    ```

    ```bash
    curl -O https://peerdb-sample-data.s3.us-east-2.amazonaws.com/quickstart_load_and_monitor.sh
    chmod +x quickstart_load_and_monitor.sh
    ./quickstart_load_and_monitor.sh
    ```

    This script begins loading data into the source table via `pgbench` for 120 seconds and then begins monitoring the source and destination tables. You can also query the tables via the PeerDB `psql` to see the data being loaded.

    ```bash
    peerdb=> SELECT * FROM peersrc.public.tablesrc ORDER BY id LIMIT 4;
    id |   c1   |   c2   |                   t
    ----+--------+--------+---------------------------------------
    1 | 439939 | 826884 | pgbenchinsert6ceeef622e794c0b548c9b9a
    2 | 789163 | 247485 | pgbenchinsert9e288b9d4064ba791d1a52c9
    3 | 868155 | 733107 | pgbenchinsert1d98fc6105547920c8ee42a8
    4 | 970751 | 865381 | pgbenchinsert12b200adbf2a07b507d11717
    (4 rows)

    peerdb=> SELECT * FROM peerdst.public.tabledst_cdc ORDER BY id LIMIT 4;
    c2   | id |                   t                   |   c1
    --------+----+---------------------------------------+--------
    826884 |  1 | pgbenchinsert6ceeef622e794c0b548c9b9a | 439939
    247485 |  2 | pgbenchinsert9e288b9d4064ba791d1a52c9 | 789163
    733107 |  3 | pgbenchinsert1d98fc6105547920c8ee42a8 | 868155
    865381 |  4 | pgbenchinsert12b200adbf2a07b507d11717 | 970751
    (4 rows)

    peerdb=> SELECT * FROM peerdst.public.tabledst_qrep ORDER BY id LIMIT 4;
    id |   c12   |   st
    ----+---------+---------
    1 | 1266823 | pgbench
    2 | 1036648 | pgbench
    3 | 1601262 | pgbench
    4 | 1836132 | pgbench
    (4 rows)
    ```

### FAQ

If you have any questions about the PeerDB setup and deployment process, don't hesitate to reach out on [Slack](https://join.slack.com/t/peerdb-public/shared_invite/zt-1wo9jydev-EXInbMtCtpAKFFWdi7QvLQ). We're more than happy to assist and answer any questions, including:

*   How long does it take to set up PeerDB?
*   How do I know my data sync is successful?
*   Can I set a specific time to start my data sync?

If there are any unanswered questions, we'd love to help you get started. Feel free to ask your questions on our community [Slack](https://join.slack.com/t/peerdb-public/shared_invite/zt-1wo9jydev-EXInbMtCtpAKFFWdi7QvLQ) channel.

In addition to this, if you require direct access to our team for any assistance, don't hesitate to contact us to discuss our premium support offerings.
